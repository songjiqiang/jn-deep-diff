<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>jn-deep-diff</title>
</head>

<body>
    <script src="../index.js"></script>
    <script>
        var oldData = {
            id: '1',
            fname: '价目表',
            fnumber: 'JMB001',
            fentry: [
                {
                    id: 'entry1',
                    fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 5,
                    fprice: 98.99,
                    fisshow: true,
                    fnote: '备注',
                    fdetail: [
                        {
                            id: 'detail1',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 5,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注'
                        },
                        {
                            id: 'detail2',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 5,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注'
                        }
                    ]
                },
                {
                    id: 'entry2',
                    fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 5,
                    fprice: 98.99,
                    fisshow: true,
                    fnote: '备注',
                    fdetail: [
                        {
                            id: 'detail1',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 5,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注'
                        }
                    ]
                }
            ]
        };

        var newData = {
            id: '1',
            fname: '价目表2',
            fnumber: 'JMB002',
            ftest: '测试',
            fint: 100,
            fnum: 89.77,
            fbool: true,
            fdetp: { id: 'bm', fname: '采购部', fnumber: 'CGB001' },
            fentry2: [
                {
                    id: 'entry1',
                    fproductid: { id: 'sp2', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 52,
                    fprice: 98.992,
                    fisshow: false,
                    fnote: '备注2'
                }
            ],
            fentry: [
                {
                    id: 'entry1',
                    fproductid: { id: 'sp2', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 52,
                    fprice: 98.992,
                    fisshow: false,
                    fnote: '备注2',
                    fdetail: [
                        {
                            id: 'detail1',
                            fproductid: { id: 'sp2', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 51,
                            fprice: 98.991,
                            fisshow: false,
                            fnote: '备注2'
                        },
                        {
                            id: 'detail2',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 53,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注',
                            fentrys: [
                                {
                                    id: 'entry1',
                                    fproductid: { id: 'sp2', fname: '衣柜1', fnumber: 'SP001' },
                                    fqty: 52,
                                    fprice: 98.992,
                                    fisshow: false,
                                    fnote: '备注2'
                                }
                            ]
                        }
                    ]
                },
                {
                    id: 'entry2',
                    fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 5,
                    fprice: 98.99,
                    fisshow: true,
                    fnote: '备注',
                    fdetail: [
                        {
                            id: 'detail1',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 5,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注'
                        }
                    ]
                },
                {
                    id: 'entry3',
                    fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                    fqty: 5,
                    fprice: 98.99,
                    fisshow: true,
                    fnote: '备注',
                    fdetail: [
                        {
                            id: 'detail1',
                            fproductid: { id: 'sp1', fname: '衣柜1', fnumber: 'SP001' },
                            fqty: 5,
                            fprice: 98.99,
                            fisshow: true,
                            fnote: '备注'
                        }
                    ]
                }
            ]
        };

        var diffData = JNDeepDiff.findDiff({
            oldData: oldData,
            newData: newData,
            //arrayComparer: function (oldEntitys, newEntity) {
            //    for (var i = 0; i < oldEntitys.length; i++) {
            //        if (oldEntitys[i]['id'] === newEntity['id']) {
            //            return oldEntitys[i];
            //        }
            //    }
            //    return null;
            //},
            //arrayComparer: 'id'
        });

        console.log(diffData);

    </script>
</body>

</html>